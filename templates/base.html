<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>{% block title %}Danh m·ª•c th·ª±c v·∫≠t - VQG B·∫°ch M√£{% endblock %}</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}"/>
  <link rel="manifest" href="{{ url_for('manifest') }}"/>
  <meta name="theme-color" content="#2E7D32"/>
</head>
<body>
  <header class="site-header">
    <div class="container header-inner">
      <img class="brand-img" src="{{ url_for('static', filename='images/logo_vn.png') }}" alt="Logo B·∫°ch M√£">
      <div style="flex:1; text-align:center;">
        <h2 class="header-title">DANH M·ª§C C√ÅC LO√ÄI TH·ª∞C V·∫¨T ‚Äì V∆Ø·ªúN QU·ªêC GIA B·∫†CH M√É</h2>
        <nav>
          <a href="{{ url_for('index') }}">Danh s√°ch lo√†i</a>
           {% if current_user.is_authenticated %}
             <a href="{{ url_for('add_species') }}">Th√™m lo√†i m·ªõi</a>
             {% if current_user.is_admin %}<a href="{{ url_for('admin_dashboard') }}">Trang qu·∫£n tr·ªã</a>{% endif %}
             <a href="{{ url_for('export_csv') }}">Xu·∫•t CSV</a>
             <a href="{{ url_for('logout') }}">ƒêƒÉng xu·∫•t ({{ current_user.username }})</a>
          {% else %}
            <a href="{{ url_for('export_csv') }}">Xu·∫•t CSV</a>
            <a href="{{ url_for('login') }}">ƒêƒÉng nh·∫≠p</a>
          {% endif %}
          <button type="button" class="btn" onclick="toggleDarkMode()">üåô Ch·∫ø ƒë·ªô t·ªëi</button>
        </nav>
      </div>
      <img class="brand-img" src="{{ url_for('static', filename='images/logo_vn2.jpg') }}" alt="C·ªïng v√†o B·∫°ch M√£">
    </div>
  </header>

  <main class="container main">
    {% with messages = get_flashed_messages() %}
      {% if messages %}
        {% for m in messages %}<div class="flash">{{ m }}</div>{% endfor %}
      {% endif %}
    {% endwith %}
    {% block content %}{% endblock %}
  </main>

  <footer class="site-footer">
    <div class="container footer-inner">
      <div>¬© {{ 2025 }} V∆∞·ªùn Qu·ªëc Gia B·∫°ch M√£.</div>
      <img class="footer-brand" src="{{ url_for('static', filename='images/logo cong vuon.jpg') }}" alt="Logo B·∫°ch M√£ l·ªõn">
    </div>
  </footer>
  <script>
    // ƒêƒÉng k√Ω Service Worker cho PWA
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', function() {
        navigator.serviceWorker.register('/service-worker.js').catch(function(e) {
          console.log('SW register fail', e);
        });
      });
    }

    function toggleDarkMode() {
      document.body.classList.toggle('dark');
      try {
        if (window.localStorage) {
          const isDark = document.body.classList.contains('dark');
          localStorage.setItem('bm_dark', isDark ? '1' : '0');
        }
      } catch (e) {}
    }

    (function() {
      try {
        if (window.localStorage && localStorage.getItem('bm_dark') === '1') {
          document.body.classList.add('dark');
        }
      } catch (e) {}
    })();
  </script>

</body>
</html>